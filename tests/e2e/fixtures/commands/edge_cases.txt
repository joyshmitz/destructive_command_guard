# Edge Case Commands - Boundary conditions for DCG
# Format: EXPECT:command
# EXPECT can be: BLOCK, ALLOW, or WARN
# Lines starting with # are comments.

# === Git add with suspicious paths (ALLOW - these are data arguments) ===
ALLOW:git add /usr/bin/something
ALLOW:git add reset --hard
ALLOW:git commit -m "Fix git push --force detection"
ALLOW:git commit -m "Document rm -rf behavior"
ALLOW:git tag -m "Document rm -rf" v1.2.3

# === File patterns containing 'git' or 'rm' (ALLOW - not commands) ===
ALLOW:cat .gitignore
ALLOW:ls .git
ALLOW:grep -r "rm -rf" docs/
ALLOW:rg -n "rm -rf" src/main.rs

# === Quoted argument patterns (ALLOW - data context) ===
ALLOW:echo "example: git reset --hard"
ALLOW:bd create --description="This pattern blocks rm -rf"
ALLOW:bd update git_safety_guard-99e --notes "example: git reset --hard"

# === Heredocs with safe content (ALLOW) ===
ALLOW:node <<EOF
console.log("hello");
EOF
ALLOW:python3 <<EOF
print("hello")
EOF

# === Heredocs with dangerous content (BLOCK) ===
BLOCK:python3 <<EOF
import shutil
shutil.rmtree("/tmp/test")
EOF
BLOCK:ruby <<EOF
require "fileutils"
FileUtils.rm_rf("/")
EOF
BLOCK:perl <<EOF
system("rm -rf /");
EOF
BLOCK:bash <<EOF
rm -rf /etc
EOF

# === Unicode variants (edge cases) ===
ALLOW:git status
ALLOW:git　status
BLOCK:git reset ‐‐hard

# === Empty and whitespace ===
ALLOW:
ALLOW:
ALLOW:echo ""

# === Very long commands (stress test) ===
ALLOW:echo "This is a very long command that goes on and on and on and on and on and on and on and on and on and on and on and on and on and on and on and on"
BLOCK:rm -rf /this/is/a/very/long/path/that/goes/on/and/on/and/on/and/on/and/on/and/on/and/on/and/on/and/on

# === Special characters ===
ALLOW:echo "hello; world"
ALLOW:echo 'single quotes'
ALLOW:echo "double quotes"
ALLOW:echo $HOME
ALLOW:echo ${HOME}

# === Command chaining (BLOCK if any dangerous) ===
BLOCK:echo hi; rm -rf /etc
BLOCK:echo hi && git reset --hard
BLOCK:ls || rm -rf /

# === Subshell execution ===
BLOCK:$(rm -rf /)
BLOCK:`rm -rf /`
BLOCK:eval "rm -rf /"

# === Environment variable assignment with command ===
ALLOW:FOO=1 git status
ALLOW:FOO=1 echo hello
BLOCK:FOO=1 bash -c "rm -rf /"
BLOCK:env FOO=1 bash -c "rm -rf /"

# === Sudo variants ===
ALLOW:sudo git status
ALLOW:sudo ls -la
BLOCK:sudo rm -rf /
BLOCK:sudo git reset --hard

# === Newlines and special escaping ===
ALLOW:echo "line1\nline2"
BLOCK:git reset\n--hard

# === Mixed case (should still match) ===
ALLOW:GIT status
ALLOW:Git Status
BLOCK:git RESET --HARD

# === Path normalization edge cases ===
ALLOW:./target/release/dcg --version
ALLOW:../other-project/run.sh
BLOCK:/usr/bin/../bin/rm -rf /

# === Flag order variations ===
BLOCK:rm --force --recursive /etc
BLOCK:rm --recursive --force /etc
BLOCK:rm -r -f /etc
BLOCK:rm -f -r /etc
BLOCK:git push origin main --force
BLOCK:git push --force origin main

# === Quoting edge cases ===
ALLOW:git commit -m 'message with "quotes"'
ALLOW:git commit -m "message with 'quotes'"
BLOCK:git "reset" --hard
BLOCK:"git" reset --hard
BLOCK:sudo "/bin/git" reset --hard
